# PixiJS 编辑器 - 使用说明

## 🎨 核心功能重构

### ✅ 已实现功能

#### 1. 统一事件系统
- **InteractionManager** - 统一处理所有交互事件
- 不再需要为每个对象单独绑定事件
- 自动进行碰撞检测和对象选择

#### 2. 工具系统
- **ToolSystem** - 根据工具模式创建不同图形
- 支持实时绘制预览
- 绘制完成后自动选中新对象

#### 3. 框选功能
- 按住鼠标拖拽即可框选多个对象
- 支持多选状态
- Ctrl + 点击可以添加/移除选择

#### 4. 变换控制器
- **TransformControls** - 完整的图形变换系统
- 8个缩放手柄（四角+四边中点）
- 旋转手柄（顶部）
- 支持拖拽移动、缩放、旋转操作

## 📖 使用指南

### 基本操作

#### 选择工具模式（默认）
- **点击选择**：点击对象即可选中
- **拖拽移动**：选中后直接拖拽移动
- **框选多选**：在空白处按住拖拽可框选多个对象
- **Ctrl + 点击**：添加/移除选择

#### 变换控制
选中对象后会显示变换控制器：
- **移动**：直接拖拽对象
- **缩放**：拖拽8个缩放手柄（四角和四边中点）
  - 角手柄：同时缩放宽度和高度
  - 边手柄：只缩放该方向
- **旋转**：拖拽顶部圆形旋转手柄

#### 平移工具
- 点击工具栏的 "平移" 按钮
- 或按住空格键
- 可以拖拽移动整个画布

#### 绘制图形
1. 点击工具栏选择工具（矩形/圆形/线条/文本）
2. 在画布上按住鼠标拖拽绘制
3. 释放鼠标完成绘制
4. 图形会自动被选中

### 快捷键

- `Ctrl + Z` - 撤销
- `Ctrl + Y` - 重做
- `Ctrl + A` - 全选
- `Space` - 临时切换到平移工具
- `Delete` - 删除选中对象
- `Esc` - 取消选择

### 图层面板

- **可见性**：点击眼睛图标切换显示/隐藏
- **锁定**：点击锁图标锁定/解锁对象
- **重命名**：点击更多按钮选择重命名
- **删除**：点击更多按钮选择删除

### 属性面板

选中对象后可以修改：
- **位置**：X, Y 坐标
- **尺寸**：宽度、高度、半径等
- **变换**：旋转、缩放
- **外观**：不透明度、填充色、描边色
- **其他**：可见性、锁定状态

## 🔧 技术架构

### 核心模块

```
InteractionManager  ← 统一交互管理
├── 对象选择（点击/框选）
├── 对象拖拽
├── 图形绘制
└── 变换控制

ToolSystem         ← 工具系统
├── 创建图形
├── 更新绘制
└── 完成绘制

PixiEngine         ← 渲染引擎
├── 对象管理
├── 图层管理
└── 事件分发
```

### 工作流程

```
用户操作
  ↓
InteractionManager (交互管理器)
  ├→ 判断工具模式
  ├→ 碰撞检测
  ├→ 创建/更新图形 (ToolSystem)
  └→ 更新变换控制器
       ↓
    PixiEngine (渲染引擎)
  ├→ 更新对象
  ├→ 触发事件
  └→ 渲染画面
       ↓
    React 组件
  ├→ 更新状态
  ├→ 更新UI
  └→ 触发回调
```

## 🎯 当前状态

### ✅ 完成
- 统一事件系统
- 工具系统（矩形、圆形、线条、文本）
- 框选功能
- 对象拖拽
- 完整的变换控制器（移动、缩放、旋转）

### 🚧 待完成
- 图层分组功能
- 分组操作
- 对齐工具
- 网格吸附

## 🐛 已知问题

1. Graphics API 兼容性
   - 部分旧代码仍在使用 v7 API
   - 需要逐步迁移到 v8 API

## 📝 下一步计划

1. **图层分组**
   - 创建分组对象
   - 分组展开/折叠
   - 拖拽到分组

2. **批量操作**
   - 多选对齐
   - 多选分组
   - 多选变换

## 💡 提示

- 绘制小图形时，系统会自动设置最小尺寸
- 锁定的对象不能移动或编辑
- 隐藏的对象不会被选中
- 框选时只会选中完全在框内的对象

---

**版本**: v2.1
**最后更新**: 2025-10-15
